---
title: "Module 3: Android Development (Version 2)"
description: "In this assignment we continue learning techniques in application architecture for the Android stack, in particular navigation and advanced state management. We will also document our progress through codelabs using git/GitHub best practises to keep track of the techiques learned and to practise useful repository management skills."
sidebar:
  hidden: false
---

<div class="first-col-header">
| A3 | Overview |
| --- | --- |
| Worth: | 8% |
| Due: | Nov 1 |
| Hand-in: | A link to a private GitHub repository, with yourself and me (`@michaelhaaf`) as collaborators |
| Notes: | [Course late penalty](/about/syllabus) applies. |
</div>

For this assignment, you will pick up two important Jetpack Compose / Android Architecture techniques (Navigation and State/Side-effect management with ViewModel) from the Android compose labs. You will also practise maintaining legible development history using git and GitHub.

Your main deliverable will be a repository containing two Pull Requests documenting your progress on each codelabs. See [Requirements](#requirements).

The actual coding part of this assignment is explained in each codelab, so there are no other instructions as such. Many of the git and GitHub techniques needed for this lab are review for you, but some are not: the [Tips](#tips) section clarifies some of the requirements and gives more detailed instructions.

A previous version of these instructions focused on git submodules -- that turned out to be more complicated than worthwhile, sorry about that. Depending on whether you already followed that instruction or not, there are a couple possible ways to easily use your existing progress in the codelabs rather than starting from scratch -- see [Getting Started](#getting-started) for more details about that.

## Goals

1. Build on Jetpack Compose knowledge
    - Learn **Navigation**
    - Learn the **View Model** and **advanced state management in Android Architecture**

2. Practise git/GitHub skills
    - Identify and separate **functional** commits in development history
    - Manage and manipulate git history to **generate pull requests with precise, intentional changes**

In essense: the main goals are **to learn the technical things about Navigation/ViewModel in Jetpack Compose the labs are trying to teach you**, and in documenting that you've done so, **to learn & practise repo management habits useful for your project milestones**-- that is, to learn to stop worrying and love `git` (if you don't already).


## Requirements

Your submission will be a **private** GitHub repository, with @michaelhaaf invited as a collaborator, called **Assignment 3** (or similar, the name isn't that important). The rest of the requirements in the marking scheme below are things that should be in that repository by the deadline.

**Tentative Marking Scheme**

The exact weights may change slightly, but should serve as a guide for the rough proportions for each part of the assignment.

- (8) A main branch containing your initial code (the two codelab starting points)
- (18) A development branch called `nav-codelab` (or similar) tracking your progress through the [Navigation Codelab][navigation-codelab]
- (18) A development branch called `advstate-codelab` (or similar) tracking your progress through the [Advanced State Codelab][adv-state-codelab]
- (18) An open pull request from the `nav-codelab` branch to `main`
- (18) An open pull request from the `advstate-codelab` branch to `main`

There are a total of 80 marks available. The rubric details for each requirement follow in the sections below.

### (8) Main branch requirements

[gitignore]: https://github.com/github/gitignore/blob/main/Android.gitignore

- (2) Repository requirements met (private, @michaelhaaf collaborator, begins as bare repository with only default Initial commit)
- (2) [Android template `.gitignore`][gitignore], either included in Initial commit, or added in a subsequent commit immediately after. **Don't forget this step** -- your subsequent commits will be affected by the presence of this file in an important way.
- (2) One commit with message title "init NavigationCodelab" containing ONLY the the addition of the NavigationCodelab stater code directory
- (2) One commit with message title "init AdvancedStateAndSideEffectsCodelab" containing ONLY the the addition of the AdvancedStateAndSideEffectsCodelab starter code directory

Suggestion: This repo should begin as a **bare repository** with nothing and only yourself and me (@michaelhaaf) as collaborators. Do not fork another branch to begin this repository. See [Getting Started](#getting-started) for more details, whether you are starting from scratch or you have progress from the previous version of this assignment you want to adapt.

### (36) Development branch requirements

[git-lec-notes]: /5A6-F23/lectures/development/01-git

The following requirements apply to both development branches (15 marks for each codelab)

- (8) Marks for progress on the codelab itself
  - If you finish the whole codelab, you get full marks -- partial marks for partial progress.
  - Feel free to make use of the guided solutions provided in the tutorial -- **make sure you try the steps yourself and understand the accompanying tutorial**. Most of the marks are for your commit messages explaining the changes made, as you'll see below. 
- (10) Marks for quality of commit messages tracking your progress
  - Your commit history should document each **functional change** required by the labs into **separate commits**.
  - **Commit messages** should demonstrate best practises outlined in the [git/github lecture notes][git-lec-notes].

You can see more details/examples of what I'm looking for in the [Making precise commits](#making-precise-commits) section below.

NOTE: The idea isn't to get it perfect the first time! One of the goals of this lab is to practise [Tailoring commit history](#tailoring-commit-history) so that you can [Update Pull Requests](#updating-pull-requests) with confidence (links go to Tips section below). That is, learning how to use `git` to rewrite/tweak/edit/squash/create local branch commits before pushing/updating a pull request.


### (36) Pull request requirements

[template-nav]: https://github.com/michaelhaaf/5A6-F23-assignment3/pull/1#issue-1958579519
[template-state]: https://github.com/michaelhaaf/5A6-F23-assignment3/pull/2#issue-1958594678
[template-pr]: https://github.com/michaelhaaf/5A6-F23-assignment3/blob/main/.github/pull_request_template.md

The following requirements apply to both development branches (18 marks for each codelab)

- (8) Marks for pull request management
  - should be a linear set of commits from the appropriate branch
  - updates to the pull request done directly, rather than creating new pull requests
  - pull request template used for entering codelab progress / answering codelab questions. This should be pushed to main branch after the previous initial commits. [Link to sample template][template-pr]
- (10) Marks for progress on codelab documented/answers to questions about each codelab. See questions below.
  - [Questions for NavigationCodelab][template-nav]
  - [Questions for AdvancedStateAndSideEffectsCodelab][template-state]

The questions are short and aren't intended to take you too much time -- they are there simply to make sure you noticed/understood some foundational concepts from each codelab.

The Pull Request template you are using/adapting is explained in more detail in the [Creating a Pull Request template](#creating-a-pull-request-template) section.

## Tips

The tips provide below aren't comprehensive (e.g. there's no step-by-step instructions for creating the repository) or all strictly necessary (i.e. there's more than one way to meet the requirements of the assignment stated above) but should serve as a useful guideline for the main tasks. 

- For creating the initial repository and commits (make sure to adapt these steps to the A4 codelabs), see [Getting Started (Assignment 3)][init-commits]
- Using developer branches: see [Using developer branches][using-dev-branches]
- Writing good commit messages: see [Commit best practises][commit-best-practises]
- Making precise commits: see [Making precise commits][making-precise-commits]
- Tailoring commit history: see [Tailoring commit history][tailoring-commit-history]
- Creating a pull request template: see [Creating a pull request template][creating-a-pull-request-template]
- Updating pull requests: see [Updating pull requests][update-pull-requests]
- Creating a pull request template: see [Creating a pull request template][template-pr]

[init-commits]: /5A6-F23/assignments/assignment-3/#getting-started
[using-dev-branches]: /5A6-F23/lectures/development/01-git-basics/#using-developer-branches
[commit-best-practises]: /5A6-F23/lectures/development/01-git-basics/#commit-best-practices
[making-precise-commits]: /5A6-F23/lectures/development/02-git-advanced/#precise-change-selection-with-git-add---patch
[tailoring-commit-history]: /5A6-F23/lectures/development/02-git-advanced/#interactive-git-rebase
[creating-a-pull-request-template]: /5A6-F23/lectures/development/03-ci-cd/#creating-a-pull-request-template
[update-pull-requests]: /5A6-F23/lectures/development/03-ci-cd/#updating-pull-requests

### Getting started

One of the [requirements for the main repository](#4-main-branch-requirements) is to create two initial commits adding *just* the starter code for each project. Both the [Navigation][navigation-codelab] and [Advanced State][adv-state-codelab] starter code comes from the same repository: [android codelabs](https://github.com/android/codelab-android-compose.git). 

There's a couple ways to go about adding this code to your assignment -- one way to do that is shown below.

```bash
## Acquire codelab code, either by downloading/extracting the .zip or cloning
git clone https://github.com/android/codelab-android-compose.git

## Copy codelab code to your Assignment3 repository
cp -R codelab-android-compose/NavigationCodelab /path/to/your/a3repository
cp -R codelab-android-compose/AdvancedStateAndSideEffectsCodelab /path/to/your/a3repository

## Initialize your repository history.
## Double check that your repository has a .gitignore committed already before proceeding!
cd /path/to/your/a3repository/
git add NavigationCodelab
## See "Making precise commits" for more detail about the use of two "-m" arguments
git commit -m "init NavigationCodelab" -m "Starter code for NavigationCodeLab from android/codelab-android-compose"

git add AdvancedStateAndSideEffectsCodelab
git commit -m "init AdvancedStateAndSideEffectsCodelab" -m "Starter code for AdvancedStateAndSideEffectsCodelab from android/codelab-android-compose"

## Creating development branches after the starter code is present
git switch -c nav-codelab
## ... navigation codelab commits ready to push
git push --set-upstream origin nav-codelab
```

At this point, you're ready to begin working on your labs! Remember to use your development branches to track your progress. If you accidentally commit to main instead, it's fixable -- as long as you don't push.

:::tip[Android Studio Tip]
To use independent projects located in the same directory with Android Studio correctly, make sure that you **open the project at the project root**, that is, the directory which contains all of the project files. E.g., for the **NavigationCodelab**, the project root is the **NavigationCodelab** directory.
:::

### Adapting existing progress

Depending on how much progress you made on the codelabs before Version 2 of the instructions was published, you may also have existing progress on the codelabs you want to use.

The two workflows below were covered in class on Wednesday, Oct 25. They assume you already have the initial repository set up with init commits on `main`.

import { Tabs, TabItem } from '@astrojs/starlight/components';

<Tabs>
  <TabItem label="(Recommended) Adapt code changes">

The most straightforward way to preserve your existing changes is to simply copy them, overwriting the starter code. The interesting part is then creating *discrete commits* from the big blob of changes, depending on how much progress you made.

The main tools used:
  - `git status / git diff`
  - `git add --patch / git add -p`
  - `git rebase --interactive / git rebase -i`

```bash
## Ensure you are on the correct branch, nav-codelab for example
## (same steps apply for other codelab)
cd /path/to/your/a3repository
git switch nav-codelab

## Copy your codelab code progress, overwriting starter code
cp -R /path/to/your/codelabprogress/NavigationCodelab ./NavigationCodelab

## Double check changes: ensure that ONLY your codelab progress is "unstaged"
## I.e. you should not see a bunch of new files in the diff, just the modifications you made to the starter code
git status
git diff

## *** Begin interactive add workflow: stage one "change" at a time ***
## see "Making precise commits" for more detail
git add /path/to/unstaged/file # if all changes to file are needed
git add -p /path/to/unstaged/file # if only some changes to file are needed

## Double check that only desired changes are staged 
git status
git diff --staged

## Commit staged changes. "-m" not recommended, see "Making precise commits" for more detail
git commit
## *** Repeat interactive add workflow until all commits are made ***

## At any time: modify commits using interactive rebase workflow
git rebase -i HEAD~3 # interactive rewrite last 3 commits (4 including HEAD)
```

  </TabItem>
  <TabItem label="(Fancy) Adapt commit history">

If, like me, you had started making commits on a submodule due to the previous instructions of this assignment, you may be interested in keeping that commit history.

The first thing to know: there's no reason to be so attached to your previous commits. I actually was happy to rewrite the commits and double check that they made sense by doing the manual (Recommended) workflow.

That said, if you insist, there is a very cool old-fashioned `git` concept that is perfect for this problem: `git patch`. It comes from the days before ubiquitous GitHub/Gitlab/etc. availability, when developers would *email* code changes to eachother in large mailing lists -- there needed to be a repository-agnostic way to apply commit differences (with messages/history intact) from one developer's repo to another.

The following is a rough outline to using git patch, adapted from https://www.devroom.io/2009/10/26/how-to-create-and-apply-a-patch-with-git/ . You will likely need to adapt it for your own codelab progress if the steps below aren't quite right.

```bash
## Create a git patch file where you have codelab progress
## i.e. a file that records all of the commits difference data on your branch against main 
cd /path/to/your/codelabprogress
git switch name-of-dev-branch-you-used # if you did not make a branch, checkout the first commit of your changes, and create a branch from that
git format-patch main --stdout > ~/codelab_progress.patch # the location of this file doesn't matter

## Prepare A3 repository
cd /path/to/your/a3repository
git switch nav-codelab # ensure you are on correct branch, e.g. nav-codelab

## Take a look at changes in patch
git apply --stat ~/codelab_progress.patch

## Check if there wil be conflicts/errors in patch
git apply --check ~/codelab_progress.patch

## Apply the patch
git apply ~/codelab_progress.patch

## Double check changes
git status

## At any time: modify commits using interactive rebase workflow
git rebase -i HEAD~3 # interactive rewrite last 3 commits (4 including HEAD)
```

  </TabItem>
</Tabs>

[navigation-codelab]: https://developer.android.com/codelabs/jetpack-compose-navigation#0
[adv-state-codelab]: https://developer.android.com/codelabs/jetpack-compose-advanced-state-side-effects#0


